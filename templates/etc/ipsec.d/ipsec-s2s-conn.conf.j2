##
conn ipsec-s2s-conn
  authby=secret
  type=tunnel
  auto=start
  pfs=yes

  # SITE A VPN SPEC
  left={{ leftGatewayIDOutside }}
  leftsourceip={{ leftGatewayIdInside}}
  leftsubnet= {{ leftSubnetCIDR }}
  leftnexthop=%defaultroute

  # SITE B VPN SPEC
  right={{ rightGatewayIDOutside }}
  rightsourceip={{ rightGatewayIdInside}}
  rightsubnet={{ rightSubnetCIDR }}
  rightnexthop=%defaultroute


  {% if 'centos|redhat' in os %}
  ike=3des-md5
  {% endif %}
  ## phase 1 ##
  keyexchange=ike
  ## phase 2 ##
  {% if 'debian in os'}
  esp=3des-md5
  {% elif 'redhat|centos' in os %}
  phase2=esp
  phase2alg=3des-md5
  compress=no
  {% endif %}
